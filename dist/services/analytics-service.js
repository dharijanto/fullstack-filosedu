var path=require("path"),Promise=require("bluebird");const AppConfig=require(path.join(__dirname,"../app-config"));var CRUDService=require(path.join(__dirname,"crud-service"));const TAG="AnalyticsService";class AnalyticsService extends CRUDService{addVideoData(e,a,i,r=null){return new Promise((t,s)=>{"feedback"!==e&&"view"!==e&&"skip"!==e&&"viewDuration"!==e?t({status:!1,errMessage:"Invalid analytics key!"}):this.create({modelName:"Analytics",data:{key:e,value:a,type:"video",userId:r,videoId:i,onCloud:AppConfig.CLOUD_SERVER}}).then(e=>{t(e)}).catch(e=>{s(e)})})}addExerciseData(e,a,i,r=null){return new Promise((t,s)=>{"backToVideo"!==e&&"questionTime"!==e&&"setTime"!==e&&"correctAnswers"!==e&&"attemptedAnswers"!==e?t({status:!1,errMessage:"Invalid analytics key!"}):this.create({modelName:"Analytics",data:{key:e,value:a,type:"exercise",userId:r,exerciseId:i,onCloud:AppConfig.CLOUD_SERVER}}).then(e=>{t(e)}).catch(e=>{s(e)})})}}module.exports=AnalyticsService;
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9zZXJ2aWNlcy9hbmFseXRpY3Mtc2VydmljZS5qcyJdLCJuYW1lcyI6WyJwYXRoIiwicmVxdWlyZSIsIlByb21pc2UiLCJBcHBDb25maWciLCJqb2luIiwiX19kaXJuYW1lIiwiQ1JVRFNlcnZpY2UiLCJUQUciLCJBbmFseXRpY3NTZXJ2aWNlIiwiW29iamVjdCBPYmplY3RdIiwia2V5IiwidmFsdWUiLCJ2aWRlb0lkIiwidXNlcklkIiwicmVzb2x2ZSIsInJlamVjdCIsInN0YXR1cyIsImVyck1lc3NhZ2UiLCJ0aGlzIiwiY3JlYXRlIiwibW9kZWxOYW1lIiwiZGF0YSIsInR5cGUiLCJvbkNsb3VkIiwiQ0xPVURfU0VSVkVSIiwidGhlbiIsInJlc3AiLCJjYXRjaCIsImVyciIsImV4ZXJjaXNlSWQiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxJQUFJQSxLQUFPQyxRQUFRLFFBQ2ZDLFFBQVVELFFBQVEsWUFFdEIsTUFBTUUsVUFBWUYsUUFBUUQsS0FBS0ksS0FBS0MsVUFBVyxrQkFDL0MsSUFBSUMsWUFBY0wsUUFBUUQsS0FBS0ksS0FBS0MsVUFBVyxpQkFFL0MsTUFBTUUsSUFBTSx5QkFVWkMseUJBQStCRixZQXVCN0JHLGFBQWNDLEVBQUtDLEVBQU9DLEVBQVNDLEVBQVMsTUFDMUMsT0FBTyxJQUFJWCxRQUFRLENBQUNZLEVBQVNDLEtBQ2YsYUFBUkwsR0FBOEIsU0FBUkEsR0FBMEIsU0FBUkEsR0FBMEIsaUJBQVJBLEVBQzVESSxHQUFTRSxRQUFRLEVBQU9DLFdBQVksMkJBRXBDQyxLQUFLQyxRQUNIQyxVQUFXLFlBQ1hDLE1BQ0VYLElBQUFBLEVBQ0FDLE1BQUFBLEVBQ0FXLEtBQU0sUUFDTlQsT0FBQUEsRUFDQUQsUUFBQUEsRUFDQVcsUUFBU3BCLFVBQVVxQixnQkFFcEJDLEtBQUtDLElBQ05aLEVBQVFZLEtBQ1BDLE1BQU1DLElBQ1BiLEVBQU9hLE9BNEJmbkIsZ0JBQWlCQyxFQUFLQyxFQUFPa0IsRUFBWWhCLEVBQVMsTUFDaEQsT0FBTyxJQUFJWCxRQUFRLENBQUNZLEVBQVNDLEtBQ2YsZ0JBQVJMLEdBQWlDLGlCQUFSQSxHQUNqQixZQUFSQSxHQUE2QixtQkFBUkEsR0FBb0MscUJBQVJBLEVBQ25ESSxHQUFTRSxRQUFRLEVBQU9DLFdBQVksMkJBRXBDQyxLQUFLQyxRQUNIQyxVQUFXLFlBQ1hDLE1BQ0VYLElBQUFBLEVBQ0FDLE1BQUFBLEVBQ0FXLEtBQU0sV0FDTlQsT0FBQUEsRUFDQWdCLFdBQUFBLEVBQ0FOLFFBQVNwQixVQUFVcUIsZ0JBRXBCQyxLQUFLQyxJQUNOWixFQUFRWSxLQUNQQyxNQUFNQyxJQUNQYixFQUFPYSxRQU9qQkUsT0FBT0MsUUFBVXZCIiwiZmlsZSI6InNlcnZpY2VzL2FuYWx5dGljcy1zZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsidmFyIHBhdGggPSByZXF1aXJlKCdwYXRoJylcbnZhciBQcm9taXNlID0gcmVxdWlyZSgnYmx1ZWJpcmQnKVxuXG5jb25zdCBBcHBDb25maWcgPSByZXF1aXJlKHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi9hcHAtY29uZmlnJykpXG52YXIgQ1JVRFNlcnZpY2UgPSByZXF1aXJlKHBhdGguam9pbihfX2Rpcm5hbWUsICdjcnVkLXNlcnZpY2UnKSlcblxuY29uc3QgVEFHID0gJ0FuYWx5dGljc1NlcnZpY2UnXG5cbi8qXG4gIEltcG9ydGFudCBOb3RlOlxuICAgIGFuYWx5dGljcyBoYXMgJ29uQ2xvdWQnIGNvbHVtblxuICAgIHdoaWNoIGluZGljYXRlIHRoYXQgdGhlIGRhdGEgaXMgYWxyZWFkeSBvbiB0aGUgY2xvdWQgYW5kIHdlIGRvbid0IG5lZWQgdG9cbiAgICBzZW5kIHRoZW0gYWdhaW4gd2hlbiBzeW5jaW5nLlxuXG4gICAgUmVtZW1iZXIgdG8gc2V0IHRoZSB2YWx1ZSBwcm9wZXJseSFcbiovXG5jbGFzcyBBbmFseXRpY3NTZXJ2aWNlIGV4dGVuZHMgQ1JVRFNlcnZpY2Uge1xuICAvKlxuICAgIHR5cGU6ICdmZWVkYmFjayc6XG4gICAgICBTbWlsZXkgZmFjZSBhdCB0aGUgZW5kIG9mIHZpZGVvXG4gICAgICBWYWx1ZTogLTEgLT4gRGlzbGlrZSwgMSAtPiBMaWtlXG4gICAgICBBZ2dyZWdhdGUgdGhlIHJldmlldyBieSBzdW1taW5nIHRoZW1cblxuICAgIHR5cGU6ICd2aWV3JzpcbiAgICAgIHZpZGVvLm9uZSgncGxheScpXG4gICAgICBXaGVuIHBhZ2UgaXMgbG9hZGVkLCBmaXJzdCBwcmVzcyB0byBwbGF5IGJ1dHRvbiBpcyBjb25zaWRlcmVkICd2aWV3J1xuICAgICAgVmFsdWU6IDFcblxuICAgIHR5cGU6ICd2aWV3RHVyYXRpb24nOlxuICAgICAgc3RhcnQ6IHZpZGVvLm9uKCdwbGF5JylcbiAgICAgIHN0b3A6IHZpZGVvLm9uKCdwYXVzZScpIG9yIGJyb3dzZXIgY2xvc2VkXG4gICAgICBWYWx1ZTogW3NlY29uZHNdXG5cbiAgICB0eXBlOiAnc2tpcCc6XG4gICAgICBOZXcgdmlldyBpcyBhIG5ldyBlbnRyeSBpbiB0aGUgdGFibGUgc28gd2UgY2FuIHNlZSBhIHN0dWRlbnQncyB0cmVuZFxuICAgICAgU3R1ZGVudCBkb2Vzbid0IHBsYXkgdGhlIHZpZGVvLCBidXQgaW1tZWRpYXRlbHkgZ29lcyB0byBleGVyY2lzZSBwYWdlXG4gICAgICB2aWRlby5vbmUoJ3BsYXknKSBkb2Vzbid0IHRyaWdnZXIsIGV4ZXJjaXNlIGJ1dHRvbiBpcyBwcmVzc2VkXG4gICAgICBWYWx1ZTogMVxuICAqL1xuICBhZGRWaWRlb0RhdGEgKGtleSwgdmFsdWUsIHZpZGVvSWQsIHVzZXJJZCA9IG51bGwpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgaWYgKGtleSAhPT0gJ2ZlZWRiYWNrJyAmJiBrZXkgIT09ICd2aWV3JyAmJiBrZXkgIT09ICdza2lwJyAmJiBrZXkgIT09ICd2aWV3RHVyYXRpb24nKSB7XG4gICAgICAgIHJlc29sdmUoe3N0YXR1czogZmFsc2UsIGVyck1lc3NhZ2U6ICdJbnZhbGlkIGFuYWx5dGljcyBrZXkhJ30pXG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmNyZWF0ZSh7XG4gICAgICAgICAgbW9kZWxOYW1lOiAnQW5hbHl0aWNzJyxcbiAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBrZXksXG4gICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgIHR5cGU6ICd2aWRlbycsXG4gICAgICAgICAgICB1c2VySWQsXG4gICAgICAgICAgICB2aWRlb0lkLFxuICAgICAgICAgICAgb25DbG91ZDogQXBwQ29uZmlnLkNMT1VEX1NFUlZFUlxuICAgICAgICAgIH1cbiAgICAgICAgfSkudGhlbihyZXNwID0+IHtcbiAgICAgICAgICByZXNvbHZlKHJlc3ApXG4gICAgICAgIH0pLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgcmVqZWN0KGVycilcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgLypcbiAgICB0eXBlOiAnYmFja1RvVmlkZW8nOlxuICAgICAgVXNlciBnb2VzIGJhY2sgdG8gVGltZXZpZGVvIGZyb20gZXhlcmNpc2UsIGJ5IGNsaWNraW5nICdCYWNrIHRvIFZpZGVvJ1xuICAgICAgVmFsdWU6IDFcblxuICAgIHR5cGU6ICdxdWVzdGlvblRpbWUnOlxuICAgICAgVGltZSBzcGVuZCBiZXR3ZWVuIHF1ZXN0aW9uc1xuICAgICAgVmFsdWU6IHRpbWUgaW4gc2Vjb25kXG5cbiAgICB0eXBlOiAnc2V0VGltZSc6XG4gICAgICBUaW1lIHNwZW5kIGJldHdlZW4gYSBzZXRcbiAgICAgIFZhbHVlOiB0aW1lIGluIHNlY29uZFxuXG4gICAgdHlwZTogJ2NvcnJlY3RBbnN3ZXJzJzpcbiAgICAgIENvcnJlY3QgYW5zd2VyIGluIGEgc2V0IHN1Ym1pc3Npb25cbiAgICAgIFZhbHVlOiBwZXJjZW50YWdlIG92ZXIgYWxsIHF1ZXN0aW9uc1xuXG4gICAgdHlwZTogJ2F0dGVtcHRlZEFuc3dlcnMnOlxuICAgICAgTm9uLWVtcHR5IGFuc3dlcnMgaW4gYSBzZXQgc3VibWlzc2lvblxuICAgICAgVmFsdWU6IHBlcmNlbnRhZ2Ugb3ZlciBhbGwgcXVlc3Rpb25zXG5cbiAgKi9cbiAgYWRkRXhlcmNpc2VEYXRhIChrZXksIHZhbHVlLCBleGVyY2lzZUlkLCB1c2VySWQgPSBudWxsKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGlmIChrZXkgIT09ICdiYWNrVG9WaWRlbycgJiYga2V5ICE9PSAncXVlc3Rpb25UaW1lJyAmJlxuICAgICAgICAgIGtleSAhPT0gJ3NldFRpbWUnICYmIGtleSAhPT0gJ2NvcnJlY3RBbnN3ZXJzJyAmJiBrZXkgIT09ICdhdHRlbXB0ZWRBbnN3ZXJzJykge1xuICAgICAgICByZXNvbHZlKHtzdGF0dXM6IGZhbHNlLCBlcnJNZXNzYWdlOiAnSW52YWxpZCBhbmFseXRpY3Mga2V5ISd9KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jcmVhdGUoe1xuICAgICAgICAgIG1vZGVsTmFtZTogJ0FuYWx5dGljcycsXG4gICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgdmFsdWUsXG4gICAgICAgICAgICB0eXBlOiAnZXhlcmNpc2UnLFxuICAgICAgICAgICAgdXNlcklkLFxuICAgICAgICAgICAgZXhlcmNpc2VJZCxcbiAgICAgICAgICAgIG9uQ2xvdWQ6IEFwcENvbmZpZy5DTE9VRF9TRVJWRVJcbiAgICAgICAgICB9XG4gICAgICAgIH0pLnRoZW4ocmVzcCA9PiB7XG4gICAgICAgICAgcmVzb2x2ZShyZXNwKVxuICAgICAgICB9KS5jYXRjaChlcnIgPT4ge1xuICAgICAgICAgIHJlamVjdChlcnIpXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEFuYWx5dGljc1NlcnZpY2VcbiJdfQ==
